#!/usr/bin/env bash

set -euo pipefail

EMOJICODE_VERSION="1.0-beta.2"
EMOJICODE_DIR="Emojicode-${EMOJICODE_VERSION}-Linux-x86_64"
EMOJICODE_TAR="${EMOJICODE_DIR}.tar.gz"
EMOJICODE_URL="https://github.com/emojicode/emojicode/releases/download/v${EMOJICODE_VERSION}/${EMOJICODE_TAR}"

# Check if Emojicode is already installed
if command -v emojicodec &>/dev/null; then
  echo ">> Emojicode is already installed. Skipping..."
  exit 0
fi

# Create a temporary directory
TMP_DIR=$(mktemp -d)
trap 'rm -rf "$TMP_DIR"' EXIT

echo ">> Downloading Emojicode v${EMOJICODE_VERSION}..."
wget "$EMOJICODE_URL" -O "$TMP_DIR/emojicode.tar.gz"

echo ">> Extracting..."
tar -xzf "$TMP_DIR/emojicode.tar.gz" -C "$TMP_DIR"

echo ">> Installing Emojicode..."
"$TMP_DIR/$EMOJICODE_DIR/install.sh"

echo "âœ… Emojicode installed successfully."
